<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Modelos polinomiales | Modelos de Regresión con R</title>
  <meta name="description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Modelos polinomiales | Modelos de Regresión con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="github-repo" content="fhernanb/libro_regresion" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Modelos polinomiales | Modelos de Regresión con R" />
  
  <meta name="twitter:description" content="Libro de Modelos de Regresión con R para los estudiantes de la Escuela de Estadística de la Universidad Nacional de Colombia." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Freddy Hernández" />
<meta name="author" content="Olga Usuga" />
<meta name="author" content="Mauricio Mazo" />


<meta name="date" content="2023-05-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="indep.html"/>
<link rel="next" href="selec.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos de Regresión con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>1</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#modelo-estadístico"><i class="fa fa-check"></i>Modelo estadístico</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#función-lm"><i class="fa fa-check"></i>Función <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#clase-lm"><i class="fa fa-check"></i>Clase <code>lm</code></a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#mínimos-cuadrados-ponderados"><i class="fa fa-check"></i>Mínimos cuadrados ponderados</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#apéndice"><i class="fa fa-check"></i>Apéndice</a>
<ul>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-mínimos-cuadrados"><i class="fa fa-check"></i>Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="" data-path="rls.html"><a href="rls.html#estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Estimación por máxima verosimilitud</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>2</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#modelo-estadístico-1"><i class="fa fa-check"></i>Modelo estadístico</a>
<ul>
<li class="chapter" data-level="" data-path="rlm.html"><a href="rlm.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="predict.html"><a href="predict.html"><i class="fa fa-check"></i><b>3</b> Predicción</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#función-predict"><i class="fa fa-check"></i>Función <code>predict</code></a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-respuesta-media-eyx_0"><i class="fa fa-check"></i>Intervalo de confianza para la respuesta media <span class="math inline">\(E(y|x_0)\)</span></a></li>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#intervalo-de-confianza-para-la-predicción-de-nuevas-observaciones"><i class="fa fa-check"></i>Intervalo de confianza para la predicción de nuevas observaciones</a>
<ul>
<li class="chapter" data-level="" data-path="predict.html"><a href="predict.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simul.html"><a href="simul.html"><i class="fa fa-check"></i><b>4</b> Simulación</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#preguntas-sobre-simulación-en-stackoverflow"><i class="fa fa-check"></i>Preguntas sobre simulación en StackOverFlow</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#simulando-datos-de-un-modelo-lineal"><i class="fa fa-check"></i>Simulando datos de un modelo lineal</a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#función-simulate"><i class="fa fa-check"></i>Función <code>simulate</code></a>
<ul>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#otras-herramientas-para-simular"><i class="fa fa-check"></i>Otras herramientas para simular</a></li>
<li class="chapter" data-level="" data-path="simul.html"><a href="simul.html#videos-sugeridos"><i class="fa fa-check"></i>Videos sugeridos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ic.html"><a href="ic.html"><i class="fa fa-check"></i><b>5</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint"><i class="fa fa-check"></i>Función <code>confint</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#función-confint_sigma2"><i class="fa fa-check"></i>Función <code>confint_sigma2</code></a>
<ul>
<li class="chapter" data-level="" data-path="ic.html"><a href="ic.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="varcuali.html"><a href="varcuali.html"><i class="fa fa-check"></i><b>6</b> Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#es-posible-incluir-variables-cualitativas"><i class="fa fa-check"></i>¿Es posible incluir variables cualitativas?</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#variable-indicadora-dummy-ficticia-o-binaria"><i class="fa fa-check"></i>Variable indicadora, dummy, ficticia o binaria</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#creando-variables-indicadoras"><i class="fa fa-check"></i>Creando variables indicadoras</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-10"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#modelos-con-variables-cualitativas"><i class="fa fa-check"></i>Modelos con variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-11"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#significancia-de-variables-cualitativas"><i class="fa fa-check"></i>Significancia de variables cualitativas</a>
<ul>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-12"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="varcuali.html"><a href="varcuali.html#ejemplo-13"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ph1.html"><a href="ph1.html"><i class="fa fa-check"></i><b>7</b> Pruebas de hipótesis parte I</a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#pruebas-sobre-los-coeficientes-beta"><i class="fa fa-check"></i>Pruebas sobre los coeficientes <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-summary-cuando-beta_j0-0"><i class="fa fa-check"></i>Función <code>summary</code> cuando <span class="math inline">\(\beta_{j0} = 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-14"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#función-beta_test-cuando-beta_k0-neq-0"><i class="fa fa-check"></i>Función <code>beta_test</code> cuando <span class="math inline">\(\beta_{k0} \neq 0\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="ph1.html"><a href="ph1.html#ejemplo-15"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ph2.html"><a href="ph2.html"><i class="fa fa-check"></i><b>8</b> Pruebas de hipótesis parte II</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-sobre-todos-los-coeficientes"><i class="fa fa-check"></i>Prueba sobre todos los coeficientes</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-16"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-para-comparar-modelos-anidados"><i class="fa fa-check"></i>Prueba para comparar modelos anidados</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-17"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#función-anova"><i class="fa fa-check"></i>Función <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-18"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-19"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#summary-versus-anova"><i class="fa fa-check"></i><code>summary</code> versus <code>anova</code></a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-20"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i>Prueba razón de verosimilitud</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-21"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#comparaciones-múltiples"><i class="fa fa-check"></i>Comparaciones múltiples</a>
<ul>
<li class="chapter" data-level="" data-path="ph2.html"><a href="ph2.html#ejemplo-22"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diag1.html"><a href="diag1.html"><i class="fa fa-check"></i><b>9</b> Diagnósticos parte I</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#supuestos"><i class="fa fa-check"></i>Supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#residuales"><i class="fa fa-check"></i>Residuales</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-23"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-normalidad-de-los-errores"><i class="fa fa-check"></i>Chequeando normalidad de los errores</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-con-media-cero"><i class="fa fa-check"></i>Chequeando si errores con media cero</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-los-errores-tiene-varianza-constante"><i class="fa fa-check"></i>Chequeando si los errores tiene varianza constante</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#chequeando-si-errores-no-están-correlacionados"><i class="fa fa-check"></i>Chequeando si errores no están correlacionados</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-cumpliendo-los-supuestos"><i class="fa fa-check"></i>Ejemplo cumpliendo los supuestos</a></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-violando-los-supuestos"><i class="fa fa-check"></i>Ejemplo violando los supuestos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#gráficos-de-residuales-usando-car"><i class="fa fa-check"></i>Gráficos de residuales usando car</a>
<ul>
<li class="chapter" data-level="" data-path="diag1.html"><a href="diag1.html#ejemplo-24"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="diag2.html"><a href="diag2.html"><i class="fa fa-check"></i><b>10</b> Diagnósticos parte II</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#matriz-sombrero-o-hat"><i class="fa fa-check"></i>Matriz sombrero o hat</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#qué-es-extrapolación-oculta"><i class="fa fa-check"></i>¿Qué es extrapolación oculta?</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-25"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#reto-para-el-lector"><i class="fa fa-check"></i>Reto para el lector</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#punto-atípico-outlier-y-punto-influyente"><i class="fa fa-check"></i>Punto atípico (outlier) y punto influyente</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#prueba-de-bonferroni-para-detectar-outliers"><i class="fa fa-check"></i>Prueba de Bonferroni para detectar outliers</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-26"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#distancia-de-cook"><i class="fa fa-check"></i>Distancia de Cook</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-27"><i class="fa fa-check"></i>Ejemplo:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dffits"><i class="fa fa-check"></i>DFFITS</a></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#dfbetas"><i class="fa fa-check"></i>DFBETAS</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-28"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#estadística-press-y-r2-de-predicción"><i class="fa fa-check"></i>Estadística PRESS y <span class="math inline">\(R^2\)</span> de predicción</a>
<ul>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#ejemplo-29"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diag2.html"><a href="diag2.html#valores-de-corte-para-diagnósticos"><i class="fa fa-check"></i>Valores de corte para diagnósticos</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="homo.html"><a href="homo.html"><i class="fa fa-check"></i><b>11</b> Pruebas de Homocedasticidad</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#breusch-pagan-test"><i class="fa fa-check"></i>Breusch-Pagan Test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-30"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#white-test"><i class="fa fa-check"></i>White test</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-31"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#score-test-for-nonconstant-error-variance"><i class="fa fa-check"></i>Score test for nonconstant error variance</a>
<ul>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#ejemplo-32"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#goldfeld-quandt-test"><i class="fa fa-check"></i>Goldfeld-Quandt Test</a></li>
<li class="chapter" data-level="" data-path="homo.html"><a href="homo.html#harrison-mccabe-test"><i class="fa fa-check"></i>Harrison-McCabe test</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="indep.html"><a href="indep.html"><i class="fa fa-check"></i><b>12</b> Pruebas de independencia de los errores</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#durbin-watson-test"><i class="fa fa-check"></i>Durbin-Watson test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-33"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#breusch-godfrey-test"><i class="fa fa-check"></i>Breusch-Godfrey Test</a>
<ul>
<li class="chapter" data-level="" data-path="indep.html"><a href="indep.html#ejemplo-34"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod_poli.html"><a href="mod_poli.html"><i class="fa fa-check"></i><b>13</b> Modelos polinomiales</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-de-una-o-varias-variables"><i class="fa fa-check"></i>Modelos polinomiales de una o varias variables</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#funciones-i-y-poly"><i class="fa fa-check"></i>Funciones <code>I()</code> y <code>poly()</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#modelos-polinomiales-con-splines"><i class="fa fa-check"></i>Modelos polinomiales con splines</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-36"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-bs"><i class="fa fa-check"></i>Función <code>bs</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-37"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-38"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-lowess"><i class="fa fa-check"></i>Función <code>lowess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-39"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-loess"><i class="fa fa-check"></i>Función <code>loess</code></a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-40"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#optimización-con-superficies-de-respuesta"><i class="fa fa-check"></i>Optimización con superficies de respuesta</a>
<ul>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#función-nlminb"><i class="fa fa-check"></i>Función <code>nlminb</code></a></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#ejemplo-41"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mod_poli.html"><a href="mod_poli.html#polinomios-ortogonales"><i class="fa fa-check"></i>Polinomios ortogonales</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="selec.html"><a href="selec.html"><i class="fa fa-check"></i><b>14</b> Selección de variables</a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#akaike-information-criterion-aic"><i class="fa fa-check"></i>Akaike Information Criterion (<span class="math inline">\(AIC\)</span>)</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-loglik-y-aic"><i class="fa fa-check"></i>Funciones <code>logLik</code> y <code>AIC</code></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#métodos"><i class="fa fa-check"></i>Métodos</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#función-stepaic"><i class="fa fa-check"></i>Función <code>stepAIC</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-42"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-backward"><i class="fa fa-check"></i>Aplicación del método <strong>backward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-forward"><i class="fa fa-check"></i>Aplicación del método <strong>forward</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#aplicación-del-método-both"><i class="fa fa-check"></i>Aplicación del método <strong>both</strong></a></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#funciones-addterm-y-dropterm"><i class="fa fa-check"></i>Funciones <code>addterm</code> y <code>dropterm</code></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-43"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-olsrr"><i class="fa fa-check"></i>Paquete <strong>olsrr</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-44"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-mixlm"><i class="fa fa-check"></i>Paquete <strong>mixlm</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-45"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#paquete-leaps"><i class="fa fa-check"></i>Paquete <strong>leaps</strong></a>
<ul>
<li class="chapter" data-level="" data-path="selec.html"><a href="selec.html#ejemplo-46"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="feature_selec.html"><a href="feature_selec.html"><i class="fa fa-check"></i><b>15</b> Feature selection</a>
<ul>
<li class="chapter" data-level="" data-path="feature_selec.html"><a href="feature_selec.html#feature-selection-with-the-caret-r-package"><i class="fa fa-check"></i>Feature Selection with the Caret R Package</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="multicoli.html"><a href="multicoli.html"><i class="fa fa-check"></i><b>16</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#qué-es-multicolinealidad"><i class="fa fa-check"></i>¿Qué es multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#multicolinealidad-inducida"><i class="fa fa-check"></i>Multicolinealidad inducida</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#cómo-identificar-la-multicolinealidad"><i class="fa fa-check"></i>¿Cómo identificar la multicolinealidad?</a></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#matriz-de-correlaciones"><i class="fa fa-check"></i>Matriz de correlaciones</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-47"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#factor-de-inflación-de-la-varianza-vif"><i class="fa fa-check"></i>Factor de Inflación de la Varianza (VIF)</a>
<ul>
<li class="chapter" data-level="" data-path="multicoli.html"><a href="multicoli.html#ejemplo-48"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="algmat.html"><a href="algmat.html"><i class="fa fa-check"></i><b>17</b> Algebra matricial con R</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#matrices"><i class="fa fa-check"></i>Matrices</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-49"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#operaciones-básicas-sobre-una-matriz"><i class="fa fa-check"></i>Operaciones básicas sobre una matriz</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#rango-de-una-matriz"><i class="fa fa-check"></i>Rango de una matriz</a>
<ul>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-50"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="algmat.html"><a href="algmat.html#ejemplo-51"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="WilRog.html"><a href="WilRog.html"><i class="fa fa-check"></i><b>18</b> Notación de Wilkinson y Rogers</a>
<ul>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#qué-es-una-fórmula-en-r"><i class="fa fa-check"></i>¿Qué es una fórmula en R?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#para-qué-sirve-la-notación-de-wilkinson-y-rogers"><i class="fa fa-check"></i>¿Para qué sirve la notación de Wilkinson y Rogers?</a></li>
<li class="chapter" data-level="" data-path="WilRog.html"><a href="WilRog.html#paquete-formula-de-r"><i class="fa fa-check"></i>Paquete Formula de R</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="xy.html"><a href="xy.html"><i class="fa fa-check"></i><b>19</b> ¿Cómo obtener la matriz <span class="math inline">\(\boldsymbol{X}\)</span> y el vector <span class="math inline">\(\boldsymbol{y}\)</span>?</a>
<ul>
<li class="chapter" data-level="" data-path="xy.html"><a href="xy.html#ejemplo-52"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="important.html"><a href="important.html"><i class="fa fa-check"></i><b>20</b> Otros aspectos importantes</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#qué-otras-funciones-hay-en-r-para-ajustar-un-modelo"><i class="fa fa-check"></i>¿Qué otras funciones hay en R para ajustar un modelo?</a>
<ul>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#ejemplo-53"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#modelos-de-regresión-con-grandes-conjuntos-de-datos"><i class="fa fa-check"></i>Modelos de regresión con grandes conjuntos de datos</a></li>
<li class="chapter" data-level="" data-path="important.html"><a href="important.html#fast-lm-in-r"><i class="fa fa-check"></i>Fast <code>lm</code> in R</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="pasos.html"><a href="pasos.html"><i class="fa fa-check"></i><b>21</b> Pasos para construir modelos</a>
<ul>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-construir-un-modelo"><i class="fa fa-check"></i>Pasos para construir UN modelo</a></li>
<li class="chapter" data-level="" data-path="pasos.html"><a href="pasos.html#pasos-para-comparar-varios-modelos"><i class="fa fa-check"></i>Pasos para comparar varios modelos</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="misspecification.html"><a href="misspecification.html"><i class="fa fa-check"></i><b>22</b> Mala especificación</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod_poli" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Modelos polinomiales<a href="mod_poli.html#mod_poli" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En este capítulo se presenta una descripción breve de como ajustar modelos polinomiales con R.</p>
<div id="modelos-polinomiales-de-una-o-varias-variables" class="section level2 unnumbered hasAnchor">
<h2>Modelos polinomiales de una o varias variables<a href="mod_poli.html#modelos-polinomiales-de-una-o-varias-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cuando se construyen modelos para explicar la media de una variable respuesta <span class="math inline">\(Y\)</span>, a veces no basta con incluir las covariables <span class="math inline">\(X_1, \ldots, X_k\)</span> sino que es necesario incluir potencias de esas variables para mejorar el modelo. En las siguientes secciones se muestra como incluir potencias de las covariables en un modelo.</p>

<div class="rmdnote">
Al incluir en un modelo lineal una potencia de una variables <span class="math inline">\(X\)</span> el modelo sigue siendo lineal. El término lineal se refiere a los parámetros <span class="math inline">\(\beta\)</span> y no a las covariables.
</div>
</div>
<div id="funciones-i-y-poly" class="section level2 unnumbered hasAnchor">
<h2>Funciones <code>I()</code> y <code>poly()</code><a href="mod_poli.html#funciones-i-y-poly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Las funciones <code>I()</code> y <code>poly()</code> son utilizadas para incluir elementos polinomiales en un modelo de regresión.</p>
<ul>
<li>Use <code>I()</code> para incluir un término específico en un modelo, por ejemplo, <code>I(x^3)</code> indica que queremos solo el término <span class="math inline">\(x^3\)</span>.</li>
<li>Use <code>poly()</code> para incluir <strong>todos</strong> los términos de un polinomio hasta cierto grado, por ejemplo, <code>poly(x, degree=3)</code> indica que queremos incluir <span class="math inline">\(x\)</span>, <span class="math inline">\(x^2\)</span> y <span class="math inline">\(x^3\)</span>.</li>
</ul>
<div id="ejemplo-35" class="section level4 unnumbered hasAnchor">
<h4>Ejemplo<a href="mod_poli.html#ejemplo-35" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Como ilustración vamos a usar los datos del ejemplo 7.1 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>. En el ejemplo 7.1 se busca crear un modelo que explique la resistencia a la tensión de una bolsa en función del porcentaje de madera dura.</p>
<p>A continuación se muestran los datos usados en el ejemplo.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="mod_poli.html#cb232-1" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">5.5</span>, <span class="dv">6</span>, <span class="fl">6.5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>)</span>
<span id="cb232-2"><a href="mod_poli.html#cb232-2" aria-hidden="true" tabindex="-1"></a>resis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">6.3</span>, <span class="fl">11.1</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="fl">26.1</span>, <span class="dv">30</span>, <span class="fl">33.8</span>, <span class="dv">34</span>, <span class="fl">38.1</span>, <span class="fl">39.9</span>, <span class="dv">42</span>, <span class="fl">46.1</span>, <span class="fl">53.1</span>, </span>
<span id="cb232-3"><a href="mod_poli.html#cb232-3" aria-hidden="true" tabindex="-1"></a>           <span class="dv">52</span>, <span class="fl">52.5</span>, <span class="dv">48</span>, <span class="fl">42.8</span>, <span class="fl">27.8</span>, <span class="fl">21.9</span>)</span>
<span id="cb232-4"><a href="mod_poli.html#cb232-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">concentracion=</span>conc, <span class="at">resistencia=</span>resis)</span></code></pre></div>
<p>El siguiente código es usado para construir el diagrama de dispersión entre las variables resistencia y concentración.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="mod_poli.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb233-2"><a href="mod_poli.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x=</span>concentracion, <span class="at">y=</span>resistencia)) <span class="sc">+</span> </span>
<span id="cb233-3"><a href="mod_poli.html#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly01-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>De este diagrama se ve claramente que hay una relación de tipo no lineal entre las variables. ¿Será mejor un modelo de grado 2 que un modelo de grado 1?</p>
<p>Vamos a ajustar ambos modelos y luego los comparamos, el elemento cuadrático lo vamos a crear usando la función <code>I()</code>.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="mod_poli.html#cb234-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(resistencia <span class="sc">~</span> concentracion, <span class="at">data=</span>datos)</span>
<span id="cb234-2"><a href="mod_poli.html#cb234-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(resistencia <span class="sc">~</span> concentracion <span class="sc">+</span> <span class="fu">I</span>(concentracion<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>datos)</span></code></pre></div>
<p>Para hacer una comparación de ambos modelos vamos a agregar al diagrama de dispersión original la recta y la curva asociadas a los modelos <code>mod1</code> y <code>mod2</code> respectivamente.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="mod_poli.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x=</span>concentracion, <span class="at">y=</span>resistencia)) <span class="sc">+</span> </span>
<span id="cb235-2"><a href="mod_poli.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb235-3"><a href="mod_poli.html#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">&#39;dodgerblue1&#39;</span>) <span class="sc">+</span></span>
<span id="cb235-4"><a href="mod_poli.html#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">formula=</span>y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>) <span class="sc">+</span></span>
<span id="cb235-5"><a href="mod_poli.html#cb235-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly02-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>De la figura anterior se observa claramente que el modelo lineal no es capaz de explicar los datos, se observan zonas donde el <code>mod1</code> siempre sub-estima y otras zonas donde siempre sobre-estima.</p>
<p>Vamos a comparar ahora los modelos por medio de un análisis de varianza, el código para hacer esto es el siguiente.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="mod_poli.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1, mod2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: resistencia ~ concentracion
## Model 2: resistencia ~ concentracion + I(concentracion^2)
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1     17 2373.46                                  
## 2     16  312.64  1    2060.8 105.47 1.894e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>El valor-P de la tabla anterior nos indica que es mejor <code>mod2</code>.</p>
<p>A continuación se analizan los residuales (<span class="math inline">\(e_i\)</span> vs <span class="math inline">\(\hat{y}_i\)</span>) para ambos modelos.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="mod_poli.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb238-2"><a href="mod_poli.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="at">which=</span><span class="dv">1</span>, <span class="at">caption=</span><span class="st">&#39;Modelo lineal&#39;</span>)</span>
<span id="cb238-3"><a href="mod_poli.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="at">which=</span><span class="dv">1</span>, <span class="at">caption=</span><span class="st">&#39;Modelo cuadratico&#39;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly03-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>En la parte izquierda de la figura anterior se ve que para el modelo lineal <code>mod1</code> los residuales presentan una curvatura evidente, esto significa que falta un elemento de grado dos en la estructura del modelo <code>mod1</code>. Al lado derecho de la figura están los residuales para el modelo cuadrático, de esta figura se observa que los residuales son menores (en valor absoluto) que los residuales del <code>mod1</code> y que no presentan un patrón claro como en el caso anterior.</p>
<p>Otro punto a favor del modelo cuadrático es su <span class="math inline">\(R^2_{Adj}\)</span> que es de 0.897 frente al 0.265 del modelo lineal.</p>
<p>De lo anterior se concluye que es mejor el modelo cuadrático para explicar la resistencia en función de la concentración, el modelo ajustado está dado en la siguiente expresión.</p>
<p><span class="math display">\[\begin{align}
{Resi}_i &amp;\sim N(\hat{\mu}_i, \sigma^2), \\
\hat{\mu}_i &amp;= -6.674 + 11.764 \times Conc - 0.635 \times Conc^2, \\
\hat{\sigma} &amp;= 4.42
\end{align}\]</span></p>
</div>
</div>
<div id="modelos-polinomiales-con-splines" class="section level2 unnumbered hasAnchor">
<h2>Modelos polinomiales con splines<a href="mod_poli.html#modelos-polinomiales-con-splines" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los splines ofrecen una forma útil de ajustar un modelo cuando los datos se comportan en forma distinta en diferentes partes del rango de las <span class="math inline">\(X´s\)</span>.</p>
<p>Los splines son polinomios de orden <span class="math inline">\(k\)</span> por segmentos y los puntos de unión se llaman nodos o knots. En la siguiente figura se muestra un spline hecho de un listón de madera y con nodos de hierro para lograr una curvatura deseada.</p>
<p align="center">
<img src="images/spline_fisico.png" width="400">
</p>
<p>Un spline cúbico básico con <span class="math inline">\(h\)</span> nodos en los puntos <span class="math inline">\(t_1, t_2, \ldots, t_h\)</span> se puede escribir como:</p>
<p><span class="math display">\[
E(Y) = \sum_{j=0}^{3} \beta_{0j} x^j + \sum_{i=1}^{h} \beta_{i} (x-t_i)^3_{+}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
(x-t_i)^3_+ = \begin{cases}
(x-t_i)^3 &amp;\mbox{if } x &gt; t_i \\
0 &amp; \mbox{if } x \leq t_i
\end{cases}
\]</span></p>
<div id="ejemplo-36" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-36" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ilustración vamos a usar los datos del ejemplo 7.2 del libro de <span class="citation">E. &amp;. V. Montgomery D. &amp; Peck (<a href="#ref-mpv06" role="doc-biblioref">2006</a>)</span>. En el ejemplo 7.2 se busca crear un modelo que explique la caída de voltaje en función del tiempo por medio dos modelos:</p>
<ul>
<li>un modelo polinomial de grado tres.</li>
<li>un spline cúbico con dos nodos en <span class="math inline">\(t=6.5\)</span> y <span class="math inline">\(t=13\)</span>.</li>
</ul>
<p>Los datos utilizados en el ejemplo se muestran a continuación.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="mod_poli.html#cb239-1" aria-hidden="true" tabindex="-1"></a>drop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.33</span>, <span class="fl">8.23</span>, <span class="fl">7.17</span>, <span class="fl">7.14</span>, <span class="fl">7.31</span>, <span class="fl">7.60</span>, <span class="fl">7.94</span>, <span class="fl">8.30</span>, <span class="fl">8.76</span>, <span class="fl">8.71</span>, <span class="fl">9.71</span>,</span>
<span id="cb239-2"><a href="mod_poli.html#cb239-2" aria-hidden="true" tabindex="-1"></a>          <span class="fl">10.26</span>, <span class="fl">10.91</span>, <span class="fl">11.67</span>, <span class="fl">11.76</span>, <span class="fl">12.81</span>, <span class="fl">13.30</span>, <span class="fl">13.88</span>, <span class="fl">14.59</span>,</span>
<span id="cb239-3"><a href="mod_poli.html#cb239-3" aria-hidden="true" tabindex="-1"></a>          <span class="fl">14.05</span>, <span class="fl">14.48</span>, <span class="fl">14.92</span>, <span class="fl">14.37</span>, <span class="fl">14.63</span>, <span class="fl">15.18</span>, <span class="fl">14.51</span>, <span class="fl">14.34</span>, </span>
<span id="cb239-4"><a href="mod_poli.html#cb239-4" aria-hidden="true" tabindex="-1"></a>          <span class="fl">13.81</span>, <span class="fl">13.79</span>, <span class="fl">13.05</span>, <span class="fl">13.04</span>, <span class="fl">12.60</span>, <span class="fl">12.05</span>, <span class="fl">11.15</span>, <span class="fl">11.15</span>, </span>
<span id="cb239-5"><a href="mod_poli.html#cb239-5" aria-hidden="true" tabindex="-1"></a>          <span class="fl">10.14</span>, <span class="fl">10.08</span>,<span class="fl">9.78</span>,<span class="fl">9.80</span>,<span class="fl">9.95</span>,<span class="fl">9.51</span>)</span>
<span id="cb239-6"><a href="mod_poli.html#cb239-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">20</span>, <span class="at">by=</span><span class="fl">0.5</span>)</span>
<span id="cb239-7"><a href="mod_poli.html#cb239-7" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time=</span>time, <span class="at">drop=</span>drop)</span></code></pre></div>
<p>Usando los datos anteriores podemos construir un diagrama de dispersión para entender la relación de las variables y la ubicación de los posibles nodos (sitios donde hay cambio de curvatura).</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="mod_poli.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos, <span class="at">ylab=</span><span class="st">&quot;Voltage drop&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time (seconds)&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb240-2"><a href="mod_poli.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">6.5</span>, <span class="at">lty=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>)</span>
<span id="cb240-3"><a href="mod_poli.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">13</span>, <span class="at">lty=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>)</span>
<span id="cb240-4"><a href="mod_poli.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fl">6.5</span>, <span class="at">y=</span><span class="fl">0.3</span>, <span class="st">&#39;t=6.5&#39;</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>)</span>
<span id="cb240-5"><a href="mod_poli.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="dv">13</span>, <span class="at">y=</span><span class="fl">0.3</span>, <span class="st">&#39;t=13&#39;</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly04-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Primero vamos a ajustar el modelo polinomial cúbico, el codigo necesario es el siguiente.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="mod_poli.html#cb241-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(drop <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>), <span class="at">data=</span>datos)</span>
<span id="cb241-2"><a href="mod_poli.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = drop ~ time + I(time^2) + I(time^3), data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.3503 -0.7340 -0.1859  0.6440  1.8390 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.4910163  0.5336473  12.163 1.71e-14 ***
## time         0.7031952  0.2339552   3.006 0.004738 ** 
## I(time^2)    0.0340179  0.0273762   1.243 0.221829    
## I(time^3)   -0.0033072  0.0008992  -3.678 0.000743 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9335 on 37 degrees of freedom
## Multiple R-squared:  0.8773, Adjusted R-squared:  0.8673 
## F-statistic: 88.14 on 3 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>De la anterior salida se pueden destacar los siguientes resultados:</p>
<ul>
<li>Los residuales varían entre -1.35 y 1.83.</li>
<li>El <span class="math inline">\(R^2_{Adj}=0.8673\)</span>.</li>
<li>La estimación de <span class="math inline">\(\sigma\)</span> es 0.9335.</li>
<li>El término <span class="math inline">\(t^3\)</span> es significativo en el modelo a un nivel de significancia del 5%, eso implica que todos los términos de grado 2 y grado 1 <strong>deben</strong> permanecer en el modelo, sean o no significativos.</li>
</ul>
<p>Ahora vamos a ajustar el modelo spline cúbico con 2 nodos en <span class="math inline">\(t=6.5\)</span> y <span class="math inline">\(t=13\)</span>, el codigo necesario es el siguiente.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="mod_poli.html#cb243-1" aria-hidden="true" tabindex="-1"></a>xplus <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">0</span>, x, <span class="dv">0</span>)  <span class="co"># Auxiliar function</span></span>
<span id="cb243-2"><a href="mod_poli.html#cb243-2" aria-hidden="true" tabindex="-1"></a>time65 <span class="ot">&lt;-</span> <span class="fu">xplus</span>(time <span class="sc">-</span> <span class="fl">6.5</span>)               <span class="co"># New variable 1</span></span>
<span id="cb243-3"><a href="mod_poli.html#cb243-3" aria-hidden="true" tabindex="-1"></a>time13 <span class="ot">&lt;-</span> <span class="fu">xplus</span>(time <span class="sc">-</span> <span class="dv">13</span>)                 <span class="co"># New variable 2</span></span>
<span id="cb243-4"><a href="mod_poli.html#cb243-4" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(drop <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(time<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(time65<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(time13<span class="sc">^</span><span class="dv">3</span>), <span class="at">data=</span>datos)</span>
<span id="cb243-5"><a href="mod_poli.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = drop ~ time + I(time^2) + I(time^3) + I(time65^3) + 
##     I(time13^3), data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.45168 -0.18499 -0.03547  0.20577  0.61694 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.465678   0.200520  42.219  &lt; 2e-16 ***
## time        -1.453124   0.181586  -8.002 2.04e-09 ***
## I(time^2)    0.489889   0.043018  11.388 2.54e-13 ***
## I(time^3)   -0.029467   0.002848 -10.347 3.44e-12 ***
## I(time65^3)  0.024706   0.004039   6.116 5.43e-07 ***
## I(time13^3)  0.027112   0.003578   7.577 6.98e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2678 on 35 degrees of freedom
## Multiple R-squared:  0.9904, Adjusted R-squared:  0.9891 
## F-statistic: 725.5 on 5 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>De la anterior salida se pueden destacar los siguientes resultados:</p>
<ul>
<li>Los residuales están más cerca del cero cuando se comparan con los residuales del <code>mod1</code>.</li>
<li>El <span class="math inline">\(R^2_{Adj}=0.9891\)</span> aumentó bastante.</li>
<li>La estimación de <span class="math inline">\(\sigma\)</span> es 0.2678.</li>
<li>Todos los términos son significativos.</li>
</ul>
<p>Para hacer una comparación visual de ambos modelos vamos a construir nuevamente el diagrama de dispersión original y agregaremos las curvas ajustadas de ambos modelos. El código para hacer esto se muestra a continuación.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="mod_poli.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos, <span class="at">ylab=</span><span class="st">&quot;Voltage drop&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time (seconds)&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb245-2"><a href="mod_poli.html#cb245-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">order</span>(time)</span>
<span id="cb245-3"><a href="mod_poli.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time[i], <span class="fu">fitted</span>(mod1)[i], <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb245-4"><a href="mod_poli.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time[i], <span class="fu">fitted</span>(mod2)[i], <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb245-5"><a href="mod_poli.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb245-6"><a href="mod_poli.html#cb245-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Cubic spline model&quot;</span>, <span class="st">&quot;Cubic polynomial model&quot;</span>))</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly05-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Al observar la figura anterior se nota con claridad que el modelo cubic spline (azul) logra explicar mejor los datos, tanto en los extremos como en la parte central, eso significa que es mejor usar el modelo cubic spline para hacer predicciones futuras.</p>
<p>Usando la tabla de resumen obtenida con <code>summary(mod2)</code> se puede escribir el modelo cubic spline ajustado así:</p>
<p><span class="math display">\[\begin{align}
{Drop}_i &amp;\sim N(\hat{\mu}_i, \hat{\sigma}^2), \\
\hat{\mu}_i &amp;= 8.4657 -1.4531 t + 0.4899 t^2 -0.0295 t^3 + 0.0247 (t-6.5)^3_{+} + 0.0271 (t-13)^3_{+}, \\
\hat{\sigma} &amp;= 0.2678
\end{align}\]</span></p>
</div>
</div>
<div id="función-bs" class="section level2 unnumbered hasAnchor">
<h2>Función <code>bs</code><a href="mod_poli.html#función-bs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>bs</code> del paquete <code>splines</code> se puede utilizar para incluir <em>basic splines</em> en un modelo de regresión, la estructura básica de la función se muestra a continuación.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="mod_poli.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bs</span>(x, <span class="at">df =</span> <span class="cn">NULL</span>, <span class="at">knots =</span> <span class="cn">NULL</span>, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">intercept =</span> <span class="cn">FALSE</span>,</span>
<span id="cb246-2"><a href="mod_poli.html#cb246-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">Boundary.knots =</span> <span class="fu">range</span>(x))</span></code></pre></div>
<p>Los argumentos básicos de la función son:</p>
<ul>
<li><code>x</code>: the predictor variable. Missing values are allowed.</li>
<li><code>df</code>: degrees of freedom.</li>
<li><code>knots</code>: the internal breakpoints that define the spline.</li>
<li><code>degree</code>: degree of the piecewise polynomial—default is 3 for cubic splines.</li>
</ul>
<div id="ejemplo-37" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-37" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este ejemplo vamos a retomar el ejemplo 7.2 del libro de <span class="citation">E. &amp;. V. Montgomery D. &amp; Peck (<a href="#ref-mpv06" role="doc-biblioref">2006</a>)</span> y que fue explicado anteriormente. El objetivo es repetir el modelo <code>mod2</code> pero con la ayuda de la función <code>bs</code>, a ese nuevo modelo lo vamos a llamar <code>mod3</code>. El código necesario se muestra a continuación.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="mod_poli.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(splines)</span>
<span id="cb247-2"><a href="mod_poli.html#cb247-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(drop <span class="sc">~</span> <span class="fu">bs</span>(time, <span class="at">knots=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="dv">13</span>), <span class="at">degree=</span><span class="dv">3</span>), <span class="at">data=</span>datos)</span>
<span id="cb247-3"><a href="mod_poli.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = drop ~ bs(time, knots = c(6.5, 13), degree = 3), 
##     data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.45168 -0.18499 -0.03547  0.20577  0.61694 
## 
## Coefficients:
##                                           Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                                 8.4657     0.2005  42.219  &lt; 2e-16
## bs(time, knots = c(6.5, 13), degree = 3)1  -3.1484     0.3934  -8.002 2.04e-09
## bs(time, knots = c(6.5, 13), degree = 3)2   4.3532     0.2843  15.312  &lt; 2e-16
## bs(time, knots = c(6.5, 13), degree = 3)3   8.5518     0.3691  23.169  &lt; 2e-16
## bs(time, knots = c(6.5, 13), degree = 3)4   0.5990     0.3059   1.958 0.058192
## bs(time, knots = c(6.5, 13), degree = 3)5   1.2414     0.2871   4.324 0.000121
##                                              
## (Intercept)                               ***
## bs(time, knots = c(6.5, 13), degree = 3)1 ***
## bs(time, knots = c(6.5, 13), degree = 3)2 ***
## bs(time, knots = c(6.5, 13), degree = 3)3 ***
## bs(time, knots = c(6.5, 13), degree = 3)4 .  
## bs(time, knots = c(6.5, 13), degree = 3)5 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2678 on 35 degrees of freedom
## Multiple R-squared:  0.9904, Adjusted R-squared:  0.9891 
## F-statistic: 725.5 on 5 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Al comparar los resultados de <code>summary(mod2)</code> con <code>summary(mod3)</code> vemos sólo una pequeña coincidencia. ¿Serán iguales, similares o diferentes el <code>mod2</code> y <code>mod3</code>?</p>
<p>Para compararlos vamos a crear nuevamente el diagrama de dispersión original y vamos a agregar las curvas ajustadas para los tres modelos. El modelo <code>mod1</code> estará en color rojo, el modelo <code>mod2</code> en color azul y línea gruesa, y el modelo <code>mod3</code> en color naranja y línea delgada. a continuación el código usado.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="mod_poli.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos, <span class="at">ylab=</span><span class="st">&quot;Voltage drop&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Time (seconds)&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>))</span>
<span id="cb249-2"><a href="mod_poli.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time[i], <span class="fu">fitted</span>(mod1)[i], <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb249-3"><a href="mod_poli.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time[i], <span class="fu">fitted</span>(mod2)[i], <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">lwd=</span><span class="dv">6</span>)</span>
<span id="cb249-4"><a href="mod_poli.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time[i], <span class="fu">fitted</span>(mod3)[i], <span class="at">col=</span><span class="st">&#39;orange&#39;</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb249-5"><a href="mod_poli.html#cb249-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">2</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;orange&#39;</span>),</span>
<span id="cb249-6"><a href="mod_poli.html#cb249-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Cubic polynomial model&quot;</span>, </span>
<span id="cb249-7"><a href="mod_poli.html#cb249-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Cubic spline manually&quot;</span>,</span>
<span id="cb249-8"><a href="mod_poli.html#cb249-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Using bs()&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb249-9"><a href="mod_poli.html#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="dv">13</span>), <span class="at">lty=</span><span class="st">&#39;dotted&#39;</span>, <span class="at">col=</span><span class="st">&quot;tomato&quot;</span>) <span class="co"># adding cutpoints</span></span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/poly06-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>De la figura anterior se observa que el modelo <code>mod3</code> coincide con el modelo <code>mod2</code>.</p>
</div>
<div id="ejemplo-38" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-38" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ilustración vamos a usar los datos del ejemplo 3.1 del libro de <span class="citation">E. &amp;. V. Montgomery D. &amp; Peck (<a href="#ref-mpv06" role="doc-biblioref">2006</a>)</span>. En el ejemplo 3.1 los autores ajustaron un modelo de regresión lineal múltiple para explicar el <strong>Tiempo</strong> necesario para que un trabajador haga el mantenimiento y surta una máquina dispensadora de refrescos en función de las variables <strong>Número de Cajas</strong> y <strong>Distancia</strong>.</p>
<p>El objetivo de este ejemplo es crear los siguientes modelos para compararlos con el MSE (mean squared error).</p>
<ul>
<li>modelo lineal con cantidad y distancia.</li>
<li>modelo lineal con splines cúbicos de cantidad y distancia.</li>
</ul>
<p align="center">
<img src="images/ilustracion_refrescos.png" width="600">
</p>
<p><strong>Solución</strong></p>
<p>Los datos del ejemplo están disponibles en el paquete <strong>MPV</strong> (por los apellidos de los autores). A continuación el código para cargar los datos y una muestra de las 6 primeras observaciones de la base de datos, en total se disponen de 20 observaciones.</p>
<p>El siguiente código sirve para construir los dos modelos solicitados.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="mod_poli.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MPV)</span>
<span id="cb250-2"><a href="mod_poli.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(softdrink) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;tiempo&#39;</span>, <span class="st">&#39;cantidad&#39;</span>, <span class="st">&#39;distancia&#39;</span>)</span>
<span id="cb250-3"><a href="mod_poli.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="mod_poli.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb250-5"><a href="mod_poli.html#cb250-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-6"><a href="mod_poli.html#cb250-6" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tiempo <span class="sc">~</span> cantidad <span class="sc">+</span> distancia, <span class="at">data=</span>softdrink)</span>
<span id="cb250-7"><a href="mod_poli.html#cb250-7" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(tiempo <span class="sc">~</span> <span class="fu">bs</span>(cantidad) <span class="sc">+</span> <span class="fu">bs</span>(distancia), <span class="at">data=</span>softdrink)</span></code></pre></div>
<p>Para obtener los valores del MSE con ambos modelos hacemos lo siguiente:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="mod_poli.html#cb251-1" aria-hidden="true" tabindex="-1"></a>y_true <span class="ot">&lt;-</span> softdrink<span class="sc">$</span>tiempo</span>
<span id="cb251-2"><a href="mod_poli.html#cb251-2" aria-hidden="true" tabindex="-1"></a>y_hat1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata=</span>softdrink)</span>
<span id="cb251-3"><a href="mod_poli.html#cb251-3" aria-hidden="true" tabindex="-1"></a>y_hat2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata=</span>softdrink)</span>
<span id="cb251-4"><a href="mod_poli.html#cb251-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-5"><a href="mod_poli.html#cb251-5" aria-hidden="true" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_true <span class="sc">-</span> y_hat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb251-6"><a href="mod_poli.html#cb251-6" aria-hidden="true" tabindex="-1"></a>mse2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y_true <span class="sc">-</span> y_hat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb251-7"><a href="mod_poli.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(mse1, mse2)</span></code></pre></div>
<pre><code>##          mse1     mse2
## [1,] 9.349267 4.765153</code></pre>
<p>De la salida anterior vemos que el MSE del modelo <code>mod2</code> que tiene splines cúbicos es menor (no necesariamente mejor) que el modelo <code>mod1</code>.</p>

<div class="rmdnote">
El MSE en este ejemplo se pudo haber obtenido usando directamente los residuales.
</div>

<div class="rmdwarning">
¿Será que el modelo <code>mod2</code> está sobre parametrizado?
</div>
</div>
</div>
<div id="función-lowess" class="section level2 unnumbered hasAnchor">
<h2>Función <code>lowess</code><a href="mod_poli.html#función-lowess" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>lowess</code> (LOcally WEighted Scatterplot Smoothing) permite constuir una curva suavizada a partir de muchas regresiones de orden <strong>uno</strong> localizadas, usando una ventana que incluye un porcentaje <code>f</code> de puntos. A continuación se muestra una figura ilustrativa para entender lo que hace <code>lowess</code>.</p>
<p align="center">
<img src="images/lowess.gif" width="400">
</p>
<p>La estructura de la función <code>lowess</code> se muestra a continuación.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="mod_poli.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lowess</span>(x, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">f =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">iter =</span> <span class="dv">3</span>, <span class="at">delta =</span> <span class="fl">0.01</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(x)))</span></code></pre></div>
<p>Los argumentos básicos de la función son:</p>
<ul>
<li><code>x</code>: vector con los valores de la covariable.</li>
<li><code>y</code>: vector con los valores de la variable respuesta.</li>
<li><code>f</code>: porcentaje de puntos dentro de la ventana, por defecto es 2/3.</li>
</ul>
<div id="ejemplo-39" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-39" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ejemplo vamos a usar los datos de la base <code>Prestige</code> que se encuentra en el paquete <code>car</code>. Queremos constuir un modelo lowess para explicar la variable <code>prestige</code> en función de la variable <code>income</code>. A continuación el código para crear el diagrama de dispersión que muestra la relación entre las variables.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="mod_poli.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb254-2"><a href="mod_poli.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prestige <span class="sc">~</span> income, <span class="at">xlab=</span><span class="st">&quot;Average Income&quot;</span>,</span>
<span id="cb254-3"><a href="mod_poli.html#cb254-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Prestige&quot;</span>, <span class="at">data=</span>Prestige, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/lowess1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Para crear el modelo lowess a los datos anteriores se usa el siguiente código.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="mod_poli.html#cb255-1" aria-hidden="true" tabindex="-1"></a>mod_lowess <span class="ot">&lt;-</span> <span class="fu">lowess</span>(<span class="at">x=</span>Prestige<span class="sc">$</span>income, <span class="at">y=</span>Prestige<span class="sc">$</span>prestige, <span class="at">f=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p>El objeto <code>mod_lowess</code> es una lista con las coordenadas <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> por donde pasa la curva suavizada. A continuación el código para agregar la curva al diagrama de dispersión.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="mod_poli.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prestige <span class="sc">~</span> income, <span class="at">xlab=</span><span class="st">&quot;Average Income&quot;</span>,</span>
<span id="cb256-2"><a href="mod_poli.html#cb256-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Prestige&quot;</span>, <span class="at">data=</span>Prestige, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb256-3"><a href="mod_poli.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mod_lowess, <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&#39;tomato&#39;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/lowess2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>De la figura anterior vemos que la curva suavizada logra capturar el patrón de variación de los datos.</p>
<p>¿Qué sucede con la curva cuando cambiamos el parámetro <code>f</code>?</p>
<p>El efecto de <code>f</code> se puede ver con claridad en la siguiente figura. Cuando <code>f</code> es pequeño la curva es muy rugosa, para valores altos de <code>f</code> la curva se suaviza.</p>
<p align="center">
<img src="images/animation_lowess_Prestige.gif" width="400">
</p>
</div>
</div>
<div id="función-loess" class="section level2 unnumbered hasAnchor">
<h2>Función <code>loess</code><a href="mod_poli.html#función-loess" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La función <code>loess</code> (LOcally Estimated Scatterplot Smoothing) permite constuir una curva o superficie suavizada a partir de muchas regresiones de orden <strong>uno</strong> o <strong>dos</strong> localizadas, usando una ventana que incluye un porcentaje <code>span</code> de puntos. La función <code>loess</code> es una generalización de <code>lowess</code>.</p>
<p>La estructura de la función <code>loess</code> se muestra a continuación.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="mod_poli.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loess</span>(formula, data, weights, subset, na.action, <span class="at">model =</span> <span class="cn">FALSE</span>,</span>
<span id="cb257-2"><a href="mod_poli.html#cb257-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">span =</span> <span class="fl">0.75</span>, enp.target, <span class="at">degree =</span> <span class="dv">2</span>,</span>
<span id="cb257-3"><a href="mod_poli.html#cb257-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">parametric =</span> <span class="cn">FALSE</span>, <span class="at">drop.square =</span> <span class="cn">FALSE</span>, <span class="at">normalize =</span> <span class="cn">TRUE</span>,</span>
<span id="cb257-4"><a href="mod_poli.html#cb257-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;symmetric&quot;</span>),</span>
<span id="cb257-5"><a href="mod_poli.html#cb257-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;loess&quot;</span>, <span class="st">&quot;model.frame&quot;</span>),</span>
<span id="cb257-6"><a href="mod_poli.html#cb257-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">loess.control</span>(...), ...)</span></code></pre></div>
<p>Los argumentos básicos de la función son:</p>
<ul>
<li><code>formula</code>: fórmula usual (<code>y ~ x1 + x2 + x3 + x4</code>) para indicar la variable respuesta y las covariables. Máximo se pueden incluir 4 covariables.</li>
<li><code>data</code>: marco de datos con las variables.</li>
<li><code>degree</code>: el grado de los polinomios locales a usar, se puede elegir entre grado 1 o grado 2.</li>
<li><code>span</code>: vector con los valores de la variable respuesta.</li>
</ul>
<p>Los otros parámetros tienen valores por defecto que se pueden cambiar para obtener mejores ajustes.</p>
<div id="ejemplo-40" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-40" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como ejemplo vamos a usar los datos de la base <code>Prestige</code> que se encuentra en el paquete <code>car</code>. Queremos constuir un modelo loess para explicar la variable <code>prestige</code> en función de las variables <code>income</code> y <code>education</code>. A continuación el código para crear el diagrama de dispersión que muestra la relación entre las variables.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="mod_poli.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb258-2"><a href="mod_poli.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span>Prestige<span class="sc">$</span>income, </span>
<span id="cb258-3"><a href="mod_poli.html#cb258-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span>Prestige<span class="sc">$</span>education, </span>
<span id="cb258-4"><a href="mod_poli.html#cb258-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">z=</span>Prestige<span class="sc">$</span>prestige, <span class="at">type=</span><span class="st">&quot;scatter3d&quot;</span>, <span class="at">color=</span>Prestige<span class="sc">$</span>prestige) <span class="sc">%&gt;%</span> </span>
<span id="cb258-5"><a href="mod_poli.html#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Income&#39;</span>),</span>
<span id="cb258-6"><a href="mod_poli.html#cb258-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Education&#39;</span>),</span>
<span id="cb258-7"><a href="mod_poli.html#cb258-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Prestige&#39;</span>)))</span></code></pre></div>
<div id="htmlwidget-97bd87cf7a8cf80df5f7" style="width:480px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-97bd87cf7a8cf80df5f7">{"x":{"visdat":{"97a812c03f06":["function () ","plotlyVisDat"]},"cur_data":"97a812c03f06","attrs":{"97a812c03f06":{"x":[12351,25879,9271,8865,8403,11030,8258,14163,11377,11023,5902,7059,8425,8049,7405,6336,19263,6112,9593,4686,12480,5648,8034,25308,14558,17498,4614,3485,5092,10432,5180,6197,7562,8206,4036,3148,4348,2448,4330,4761,3016,2901,5511,3739,3161,4741,5052,6259,4075,7482,8780,2594,918,2370,8131,6992,7956,8895,8891,3116,3930,7869,611,3000,3472,3582,3643,1656,6860,4199,5134,5134,1890,4443,3485,8043,6686,6565,6477,5811,6573,3942,5449,2847,5795,7716,4696,8316,7147,8880,5299,5959,4549,6928,3910,14032,8845,5562,4224,4753,6462,3617],"y":[13.11,12.26,12.77,11.42,14.62,15.64,15.09,15.44,14.52,14.64,12.39,12.3,13.83,14.44,14.36,14.21,15.77,14.15,15.22,14.5,15.97,13.62,15.08,15.96,15.94,14.71,12.46,9.45,13.62,15.21,12.79,11.09,12.71,11.44,11.59,11.49,11.32,10.64,11.36,9.17,12.09,11.04,9.22,10.07,10.51,11.2,11.13,11.43,11,9.84,11.13,10.05,9.62,9.93,11.6,11.09,11.03,9.47,10.93,7.74,8.5,10.57,9.46,7.33,7.11,7.58,6.84,8.6,8.88,7.54,7.64,7.64,7.42,6.69,6.74,10.09,8.81,8.4,7.92,8.43,8.78,8.76,10.29,6.38,8.1,10.1,6.67,9.05,9.93,8.24,6.92,6.6,7.81,8.33,7.52,12.27,8.49,7.58,7.93,8.37,10,8.55],"z":[68.8,69.1,63.4,56.8,73.5,77.6,72.6,78.1,73.1,68.8,62,60,53.8,62.2,74.9,55.1,82.3,58.1,58.3,72.8,84.6,59.6,66.1,87.2,66.7,68.4,64.7,34.9,72.1,69.3,67.5,57.2,57.6,54.1,46,41.9,49.4,42.3,47.7,30.9,32.7,38.7,36.1,37.2,38.1,29.4,51.1,35.7,35.6,41.5,40.2,26.5,14.8,23.3,47.3,47.1,51.1,43.5,51.6,29.7,20.2,54.9,25.9,20.8,17.3,20.1,44.1,21.5,35.3,38.9,25.2,34.8,23.2,33.3,28.8,42.5,44.2,35.9,41.8,35.9,43.7,50.8,37.2,28.2,38.1,50.3,27.3,40.9,50.2,51.1,38.9,36.2,29.9,42.9,26.5,66.1,48.9,35.9,25.1,26.1,42.2,35.2],"color":[68.8,69.1,63.4,56.8,73.5,77.6,72.6,78.1,73.1,68.8,62,60,53.8,62.2,74.9,55.1,82.3,58.1,58.3,72.8,84.6,59.6,66.1,87.2,66.7,68.4,64.7,34.9,72.1,69.3,67.5,57.2,57.6,54.1,46,41.9,49.4,42.3,47.7,30.9,32.7,38.7,36.1,37.2,38.1,29.4,51.1,35.7,35.6,41.5,40.2,26.5,14.8,23.3,47.3,47.1,51.1,43.5,51.6,29.7,20.2,54.9,25.9,20.8,17.3,20.1,44.1,21.5,35.3,38.9,25.2,34.8,23.2,33.3,28.8,42.5,44.2,35.9,41.8,35.9,43.7,50.8,37.2,28.2,38.1,50.3,27.3,40.9,50.2,51.1,38.9,36.2,29.9,42.9,26.5,66.1,48.9,35.9,25.1,26.1,42.2,35.2],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Income"},"yaxis":{"title":"Education"},"zaxis":{"title":"Prestige"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[12351,25879,9271,8865,8403,11030,8258,14163,11377,11023,5902,7059,8425,8049,7405,6336,19263,6112,9593,4686,12480,5648,8034,25308,14558,17498,4614,3485,5092,10432,5180,6197,7562,8206,4036,3148,4348,2448,4330,4761,3016,2901,5511,3739,3161,4741,5052,6259,4075,7482,8780,2594,918,2370,8131,6992,7956,8895,8891,3116,3930,7869,611,3000,3472,3582,3643,1656,6860,4199,5134,5134,1890,4443,3485,8043,6686,6565,6477,5811,6573,3942,5449,2847,5795,7716,4696,8316,7147,8880,5299,5959,4549,6928,3910,14032,8845,5562,4224,4753,6462,3617],"y":[13.11,12.26,12.77,11.42,14.62,15.64,15.09,15.44,14.52,14.64,12.39,12.3,13.83,14.44,14.36,14.21,15.77,14.15,15.22,14.5,15.97,13.62,15.08,15.96,15.94,14.71,12.46,9.45,13.62,15.21,12.79,11.09,12.71,11.44,11.59,11.49,11.32,10.64,11.36,9.17,12.09,11.04,9.22,10.07,10.51,11.2,11.13,11.43,11,9.84,11.13,10.05,9.62,9.93,11.6,11.09,11.03,9.47,10.93,7.74,8.5,10.57,9.46,7.33,7.11,7.58,6.84,8.6,8.88,7.54,7.64,7.64,7.42,6.69,6.74,10.09,8.81,8.4,7.92,8.43,8.78,8.76,10.29,6.38,8.1,10.1,6.67,9.05,9.93,8.24,6.92,6.6,7.81,8.33,7.52,12.27,8.49,7.58,7.93,8.37,10,8.55],"z":[68.8,69.1,63.4,56.8,73.5,77.6,72.6,78.1,73.1,68.8,62,60,53.8,62.2,74.9,55.1,82.3,58.1,58.3,72.8,84.6,59.6,66.1,87.2,66.7,68.4,64.7,34.9,72.1,69.3,67.5,57.2,57.6,54.1,46,41.9,49.4,42.3,47.7,30.9,32.7,38.7,36.1,37.2,38.1,29.4,51.1,35.7,35.6,41.5,40.2,26.5,14.8,23.3,47.3,47.1,51.1,43.5,51.6,29.7,20.2,54.9,25.9,20.8,17.3,20.1,44.1,21.5,35.3,38.9,25.2,34.8,23.2,33.3,28.8,42.5,44.2,35.9,41.8,35.9,43.7,50.8,37.2,28.2,38.1,50.3,27.3,40.9,50.2,51.1,38.9,36.2,29.9,42.9,26.5,66.1,48.9,35.9,25.1,26.1,42.2,35.2],"type":"scatter3d","mode":"markers","marker":{"colorbar":{"title":"","ticklen":2},"cmin":14.8,"cmax":87.2,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[68.8,69.1,63.4,56.8,73.5,77.6,72.6,78.1,73.1,68.8,62,60,53.8,62.2,74.9,55.1,82.3,58.1,58.3,72.8,84.6,59.6,66.1,87.2,66.7,68.4,64.7,34.9,72.1,69.3,67.5,57.2,57.6,54.1,46,41.9,49.4,42.3,47.7,30.9,32.7,38.7,36.1,37.2,38.1,29.4,51.1,35.7,35.6,41.5,40.2,26.5,14.8,23.3,47.3,47.1,51.1,43.5,51.6,29.7,20.2,54.9,25.9,20.8,17.3,20.1,44.1,21.5,35.3,38.9,25.2,34.8,23.2,33.3,28.8,42.5,44.2,35.9,41.8,35.9,43.7,50.8,37.2,28.2,38.1,50.3,27.3,40.9,50.2,51.1,38.9,36.2,29.9,42.9,26.5,66.1,48.9,35.9,25.1,26.1,42.2,35.2],"line":{"colorbar":{"title":"","ticklen":2},"cmin":14.8,"cmax":87.2,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[68.8,69.1,63.4,56.8,73.5,77.6,72.6,78.1,73.1,68.8,62,60,53.8,62.2,74.9,55.1,82.3,58.1,58.3,72.8,84.6,59.6,66.1,87.2,66.7,68.4,64.7,34.9,72.1,69.3,67.5,57.2,57.6,54.1,46,41.9,49.4,42.3,47.7,30.9,32.7,38.7,36.1,37.2,38.1,29.4,51.1,35.7,35.6,41.5,40.2,26.5,14.8,23.3,47.3,47.1,51.1,43.5,51.6,29.7,20.2,54.9,25.9,20.8,17.3,20.1,44.1,21.5,35.3,38.9,25.2,34.8,23.2,33.3,28.8,42.5,44.2,35.9,41.8,35.9,43.7,50.8,37.2,28.2,38.1,50.3,27.3,40.9,50.2,51.1,38.9,36.2,29.9,42.9,26.5,66.1,48.9,35.9,25.1,26.1,42.2,35.2]}},"frame":null},{"x":[611,25879],"y":[6.38,15.97],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":14.8,"cmax":87.2,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[14.8,87.2],"line":{"color":"rgba(255,127,14,1)"}},"z":[14.8,87.2],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Para crear el modelo loess a los datos anteriores se usa el siguiente código.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="mod_poli.html#cb259-1" aria-hidden="true" tabindex="-1"></a>mod_loess <span class="ot">&lt;-</span> <span class="fu">loess</span>(prestige <span class="sc">~</span> income <span class="sc">+</span> education, <span class="at">data=</span>Prestige, </span>
<span id="cb259-2"><a href="mod_poli.html#cb259-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">degree=</span><span class="dv">2</span>, <span class="at">span=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p>A continuación el código para agregar la superficie al diagrama de dispersión. Los objetos <code>inc</code> y <code>edu</code> son secuencias de valores en el rango de los datos originales. El objeto <code>newdata</code> es un marco de datos con todas las combinaciones de valores de <code>inc</code> y <code>edu</code>. El objeto <code>fit.prestige</code> es una matriz con los valores estimados de la variable prestige. Luego todos esos objetos entran a la función <code>plot_ly</code>.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="mod_poli.html#cb260-1" aria-hidden="true" tabindex="-1"></a>inc <span class="ot">&lt;-</span> <span class="fu">with</span>(Prestige, <span class="fu">seq</span>(<span class="fu">min</span>(income), <span class="fu">max</span>(income), <span class="at">len=</span><span class="dv">25</span>))</span>
<span id="cb260-2"><a href="mod_poli.html#cb260-2" aria-hidden="true" tabindex="-1"></a>edu <span class="ot">&lt;-</span> <span class="fu">with</span>(Prestige, <span class="fu">seq</span>(<span class="fu">min</span>(education), <span class="fu">max</span>(education), <span class="at">len=</span><span class="dv">25</span>))</span>
<span id="cb260-3"><a href="mod_poli.html#cb260-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">income=</span>inc, <span class="at">education=</span>edu)</span>
<span id="cb260-4"><a href="mod_poli.html#cb260-4" aria-hidden="true" tabindex="-1"></a>fit.prestige <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">predict</span>(mod_loess, newdata), <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb260-5"><a href="mod_poli.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span>inc, <span class="at">y=</span>edu, <span class="at">z=</span>fit.prestige) <span class="sc">%&gt;%</span> <span class="fu">add_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb260-6"><a href="mod_poli.html#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Income&#39;</span>),</span>
<span id="cb260-7"><a href="mod_poli.html#cb260-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Education&#39;</span>),</span>
<span id="cb260-8"><a href="mod_poli.html#cb260-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Prestige&#39;</span>)))</span></code></pre></div>
<div id="htmlwidget-6c36ea86517aed90100d" style="width:480px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c36ea86517aed90100d">{"x":{"visdat":{"97a829bf1a57":["function () ","plotlyVisDat"]},"cur_data":"97a829bf1a57","attrs":{"97a829bf1a57":{"x":[611,1663.83333333333,2716.66666666667,3769.5,4822.33333333333,5875.16666666667,6928,7980.83333333333,9033.66666666667,10086.5,11139.3333333333,12192.1666666667,13245,14297.8333333333,15350.6666666667,16403.5,17456.3333333333,18509.1666666667,19562,20614.8333333333,21667.6666666667,22720.5,23773.3333333333,24826.1666666667,25879],"y":[6.38,6.77958333333333,7.17916666666667,7.57875,7.97833333333333,8.37791666666667,8.7775,9.17708333333333,9.57666666666667,9.97625,10.3758333333333,10.7754166666667,11.175,11.5745833333333,11.9741666666667,12.37375,12.7733333333333,13.1729166666667,13.5725,13.9720833333333,14.3716666666667,14.77125,15.1708333333333,15.5704166666667,15.97],"z":[[19.025035009983,18.1205538052176,17.4992267066308,17.1689670876261,17.1376883216069,17.4133037819767,18.0037268421388,18.9168560101713,20.1094526156156,21.5330972508286,23.1829656006291,25.0542333498362,27.1420761832687,29.4416697857455,31.9481898420858,34.6568120371084,37.5627120556322,40.6610655824763,43.9470483024596,47.4158359004011,51.0626040611197,54.8825284694343,58.870784810164,63.0225487681276,67.3329960281441],[22.7907403028748,21.925929067589,21.391388284829,21.1779340580594,21.2763824907445,21.677549686349,22.3722517483372,23.3513081019567,24.6157087237857,26.1627496520985,27.978814764344,30.0502879379712,32.3635530504291,34.9049939791663,37.660994601632,40.617938795275,43.7622104375442,47.0801934058885,50.5582715777569,54.1828288305982,57.9402490418613,61.8169160889952,65.7992138494489,69.873526200671,74.0262370201107],[26.4289826283065,25.5780690587266,25.0714420497941,24.8979552248548,25.0464622072543,25.5058166203382,26.2648720874523,27.3124928913641,28.6707137934909,30.3517767780215,32.3334044869861,34.5933195624153,37.1092446463394,39.8589023807889,42.8200154077941,45.9703063693856,49.2874979075936,52.7493126644487,56.3334732819812,60.0177024022215,63.7797226672001,67.5972567189473,71.4480271994937,75.3097567508694,79.1601680151051],[30.2360709298245,29.3744541344226,28.8419015573343,28.6359389975282,28.754092253973,29.1938871256373,29.9528494114897,31.028508661727,32.4271191708052,34.140104060403,36.1439918711093,38.4153111435131,40.9305904182033,43.6663582357688,46.5991431367988,49.7054736618821,52.9618783516078,56.3448857465647,59.831024387342,63.3968228145285,67.0188095687132,70.6735131904851,74.3374622204332,77.9871851991464,81.5992106672137],[34.3884096452513,33.4226397144838,32.7985740073353,32.5095955242044,32.5490872654897,32.9104322315897,33.5870134229031,34.5722427604602,35.9351489758304,37.6626675587826,39.6346824545102,41.7519226009057,44.0517874564472,46.5314284496975,49.1734137002064,51.9603113275234,54.8746894511982,57.8991161907805,61.0161596658199,64.208387995866,67.4583693004684,70.7486716991769,74.061863311541,77.3805122571104,80.6871866554347],[38.9051433882683,37.7785138266511,36.9855780707778,36.5223475393531,36.3848336510818,36.5690478246688,37.0710014788189,37.8867561403829,39.146702503636,40.8517951036158,42.8205978866643,44.8904423991132,47.0528942373138,49.3105042753597,51.6559053982909,54.0817304911471,56.5806124389677,59.1451841267927,61.7680784396617,64.4419282626143,67.1593664806902,69.9130259789292,72.6955396423709,75.499540356055,78.3176610050212],[44.2934504995279,42.8726213610329,41.8133518112184,41.1095479729036,40.7551159689078,40.7439619220505,41.0699919551508,41.7271100945738,42.6960637874384,43.9339157522579,45.3983391718991,47.0412705859411,48.8015721140483,50.6663404269146,52.6292130118151,54.6838273560251,56.8238209468198,59.0428312714744,61.3344958172643,63.6924520714645,66.1103375213504,68.5817896541972,71.1004459572801,73.6599439178743,76.2539210232551],[50.2094891167746,48.4185100651942,47.0441296627527,46.0584897351602,45.4337321081266,45.141998607362,45.1554310585764,45.4461706882823,45.9842841484675,46.739577843413,47.6836030201749,48.7954995114867,50.094492105957,51.5705104006748,53.2071789780021,54.9881224203006,56.8969653099323,58.917332229259,61.0328477606426,63.2271364864449,65.4838229890278,67.7865318507532,70.118887653983,72.4645149810789,74.8070384144029],[56.0339794720617,53.9686205919085,52.2441154160032,50.8522179477299,49.7846821904729,49.033262147616,48.5897118225435,48.4457852186394,48.5932363392879,49.0238191878729,49.7292877677786,50.6903126817682,51.8340161260457,53.1378741364767,54.5890861516659,56.1748516102174,57.8823699507358,59.6988406118257,61.6114630320912,63.607436650137,65.6739609045673,67.7982352339867,69.9674590769996,72.1688318722105,74.3895530582236],[62.2560597037113,59.8203476866717,57.7619431393099,56.0651459614117,54.7142560527627,53.6935733131487,52.9873976423552,52.5800289401681,52.4557671063728,52.5989120407553,52.993763643101,53.6230271147674,54.4616298044187,55.4916331825196,56.6964901977532,58.0596537988024,59.5645769343503,61.19471255308,62.9335136036744,64.7644330348166,66.6709237951897,68.6364388334767,70.6444310983606,72.6783535385245,74.7216591026514],[68.1482986197961,65.6626854679931,63.5080760731142,61.6720730777238,60.1422791243864,58.9062968556665,57.9517289141288,57.2661779423376,56.8372465828575,56.6525374782529,56.6996532710884,56.9661966039286,57.4397701193378,58.1079764598807,58.9584182681217,59.9786981866253,61.156418857956,62.4791829246783,63.9345930293569,65.510251814556,67.1937619228403,68.9727259967743,70.8347466789225,72.7674266118493,74.7583684381194],[72.2039459364212,69.7899744883569,67.6553777105778,65.7920394388981,64.1918435091317,62.8466737570928,61.7484140185953,60.8889481294534,60.2601599254811,59.8539332424925,59.6621519163015,59.6766997827224,59.889460677569,60.2923184366556,60.8771568957961,61.6358598908046,62.5603112574952,63.6423948316819,64.8739944491788,66.2469939457998,67.7532771573592,69.384727919671,71.1332300685491,72.9906674398078,74.9489238692609],[74.5360985541214,72.2742959419775,70.2466308405408,68.4483898628798,66.874859622063,65.521326731159,64.3830778032364,63.4553994513635,62.733578288609,62.2129009280414,61.8886539827292,61.7561240657409,61.8105977901451,62.0473617690102,62.4617026154049,63.0489069423976,63.8042613630568,64.7230524904512,65.8005669376491,67.0320913177192,68.41291224373,69.93831632875,71.6035901858477,73.4040204280916,75.3348936685503],[75.3758942119151,73.3332020859096,71.4854147916742,69.8304304699475,68.3661472614679,67.0904633069742,66.0012767472048,65.0964857228984,64.3739883747935,63.8316828436286,63.4674672701424,63.2792397950735,63.2648985591602,63.4223417031414,63.7494673677555,64.244173693741,64.9043588218367,65.7279208927809,66.7127580473124,67.8567684261696,69.1578501700912,70.6139014198156,72.2228203160816,73.9825049996276,75.8908536111922],[74.9544706488208,73.184245177208,71.5753088926493,70.1274673803798,68.8405262256341,67.7142910136471,66.7485673296536,65.9431607588886,65.2978768865868,64.8125212979832,64.4868995783124,64.3208173128094,64.314080086709,64.4664934852461,64.7778630936555,65.247994497172,65.8766932810305,66.6637650304658,67.6090153307128,68.7122497670063,69.9732739245812,71.3918933886722,72.9679137445143,74.7011405773423,76.5913794723909],[73.5029656038568,72.0449774729272,70.7198924721374,69.5288067144554,68.4728163128491,67.5530173802865,66.7705060297357,66.1263783741647,65.6217305265414,65.2576585998339,65.0352587070101,64.9556269610381,65.0198594748857,65.2290523615212,65.5843017339124,66.0867037050274,66.7373543878341,67.5373498953006,68.4877863403949,69.5897598360848,70.8443664953386,72.2527024311241,73.8158637564094,75.5349465841624,77.4110470273511],[71.2525168160414,70.132951230122,69.1227448588096,68.223754592453,67.4378373214007,66.7668499360015,66.2126493266041,65.7770923835572,65.4620359972096,65.2693370579098,65.2008524560066,65.2584390818487,65.4439538257848,65.7592535781637,66.2061952293339,66.7866356696442,67.5024317894433,68.35544047908,69.3475186289028,70.4805231292605,71.7563108705019,73.1767387429755,74.7436636370302,76.4589424430145,78.3244320512773],[68.4342620243932,67.6657187058471,66.9874453813373,66.4016171346512,65.9104090495765,65.5159962099008,65.2205536994117,65.0262566018968,64.9352800011436,64.9497989809398,65.071988625073,65.3040240173307,65.6480802415006,66.1063323813703,66.6809555207274,67.3741247433593,68.1880151330539,69.1248017735986,70.186659748781,71.3757641423888,72.6942900382095,74.1444125200308,75.7283066716403,77.4481475768254,79.3061103193739],[65.2793389679304,64.8608321571572,64.5175733683915,64.2517004613288,64.0653512956642,63.9606637310934,63.9397756273114,64.0048248440138,64.1579492408959,64.4012866776529,64.7369750139803,65.1671521095734,65.6939558241275,66.3195240173381,67.0459945489004,67.8755052785097,68.8101940658615,69.8521987706511,71.0036572525739,72.2667073713251,73.6434869866001,75.1361339580943,76.746786145503,78.4775814085216,80.3306576068454],[62.0188853856715,61.9358438411069,61.9167081486435,61.9633106927642,62.0774838579515,62.261060028688,62.5158715894563,62.843750924739,63.2465304190187,63.7260424567781,64.2841194224996,64.9225937006661,65.64329767576,66.4480637322639,67.3387242546605,68.3171116274324,69.3850582350621,70.5443964620324,71.7969586928257,73.1445773119247,74.589084703812,76.1323132529702,77.776095343882,79.5222633610298,81.3726496888964],[58.8840390166349,59.1083060147508,59.3884290507646,59.7257539492363,60.1216265347259,60.5773926317936,61.0943980649991,61.6739886589028,62.3175102380644,63.0263086270442,63.8017296504021,64.6451191326981,65.5578228984923,66.5411867723447,67.5965565788153,68.7252781424642,69.9286972878514,71.208159839537,72.5650116220809,74.0005984600431,75.5162661779838,77.113360600463,78.7932275520406,80.5572128572768,82.4066623407314],[56.1059375998389,56.5957709351438,57.1363154034259,57.7283363510237,58.3725991242753,59.069869069519,59.820911533093,60.6264918613357,61.4873754005854,62.4043274971803,63.3781134974586,64.4094987477587,65.4992485944188,66.6481283837773,67.8569034621723,69.1263391759422,70.4572008714252,71.8502538949596,73.3062635928837,74.8259953115358,76.4102143972541,78.0596861963768,79.7751760552424,81.557449320189,83.407271337555],[53.9157188743019,54.6157908593404,55.3639465352988,56.160364018405,57.0052214248871,57.8986968709731,58.8409684728908,59.8322143468685,60.8726126091339,61.9623413759152,63.1015787634404,64.2905028879373,65.5292918656341,66.8181238127587,68.157176845539,69.5466290802032,70.9866586329793,72.477443620095,74.0191621577787,75.611992362258,77.2561123497612,78.9517002365161,80.6989341387508,82.4979921726932,84.3490524545715],[52.5445205790424,53.3859180443954,54.2749017750543,55.211143071659,56.1943132348491,57.2240835652647,58.3001253635455,59.4221099303315,60.5897085662624,61.8025925719781,63.0604332481184,64.3629018953232,65.7096698142323,67.1004083054857,68.5347886697231,70.0124822075844,71.5331602197094,73.096494006738,74.70215486931,76.3498141080653,78.0391430236437,79.769812916685,81.5414950878293,83.3538608377161,85.2065814669855],[52.2234804530787,53.1237047473635,54.0727604513638,55.0699796310642,56.114694352449,57.2062366815028,58.3439386842101,59.5271324265553,60.755149974523,62.0273233940977,63.3429847512637,64.7014661120057,66.102099542308,67.5442171081553,69.027150875532,70.5502329104225,72.1127952788113,73.714170046683,75.3536892800221,77.0306850448129,78.7444894070401,80.494434432688,82.2798521877413,84.1000747381843,85.9544341500016]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Income"},"yaxis":{"title":"Education"},"zaxis":{"title":"Prestige"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666666","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[611,1663.83333333333,2716.66666666667,3769.5,4822.33333333333,5875.16666666667,6928,7980.83333333333,9033.66666666667,10086.5,11139.3333333333,12192.1666666667,13245,14297.8333333333,15350.6666666667,16403.5,17456.3333333333,18509.1666666667,19562,20614.8333333333,21667.6666666667,22720.5,23773.3333333333,24826.1666666667,25879],"y":[6.38,6.77958333333333,7.17916666666667,7.57875,7.97833333333333,8.37791666666667,8.7775,9.17708333333333,9.57666666666667,9.97625,10.3758333333333,10.7754166666667,11.175,11.5745833333333,11.9741666666667,12.37375,12.7733333333333,13.1729166666667,13.5725,13.9720833333333,14.3716666666667,14.77125,15.1708333333333,15.5704166666667,15.97],"z":[[19.025035009983,18.1205538052176,17.4992267066308,17.1689670876261,17.1376883216069,17.4133037819767,18.0037268421388,18.9168560101713,20.1094526156156,21.5330972508286,23.1829656006291,25.0542333498362,27.1420761832687,29.4416697857455,31.9481898420858,34.6568120371084,37.5627120556322,40.6610655824763,43.9470483024596,47.4158359004011,51.0626040611197,54.8825284694343,58.870784810164,63.0225487681276,67.3329960281441],[22.7907403028748,21.925929067589,21.391388284829,21.1779340580594,21.2763824907445,21.677549686349,22.3722517483372,23.3513081019567,24.6157087237857,26.1627496520985,27.978814764344,30.0502879379712,32.3635530504291,34.9049939791663,37.660994601632,40.617938795275,43.7622104375442,47.0801934058885,50.5582715777569,54.1828288305982,57.9402490418613,61.8169160889952,65.7992138494489,69.873526200671,74.0262370201107],[26.4289826283065,25.5780690587266,25.0714420497941,24.8979552248548,25.0464622072543,25.5058166203382,26.2648720874523,27.3124928913641,28.6707137934909,30.3517767780215,32.3334044869861,34.5933195624153,37.1092446463394,39.8589023807889,42.8200154077941,45.9703063693856,49.2874979075936,52.7493126644487,56.3334732819812,60.0177024022215,63.7797226672001,67.5972567189473,71.4480271994937,75.3097567508694,79.1601680151051],[30.2360709298245,29.3744541344226,28.8419015573343,28.6359389975282,28.754092253973,29.1938871256373,29.9528494114897,31.028508661727,32.4271191708052,34.140104060403,36.1439918711093,38.4153111435131,40.9305904182033,43.6663582357688,46.5991431367988,49.7054736618821,52.9618783516078,56.3448857465647,59.831024387342,63.3968228145285,67.0188095687132,70.6735131904851,74.3374622204332,77.9871851991464,81.5992106672137],[34.3884096452513,33.4226397144838,32.7985740073353,32.5095955242044,32.5490872654897,32.9104322315897,33.5870134229031,34.5722427604602,35.9351489758304,37.6626675587826,39.6346824545102,41.7519226009057,44.0517874564472,46.5314284496975,49.1734137002064,51.9603113275234,54.8746894511982,57.8991161907805,61.0161596658199,64.208387995866,67.4583693004684,70.7486716991769,74.061863311541,77.3805122571104,80.6871866554347],[38.9051433882683,37.7785138266511,36.9855780707778,36.5223475393531,36.3848336510818,36.5690478246688,37.0710014788189,37.8867561403829,39.146702503636,40.8517951036158,42.8205978866643,44.8904423991132,47.0528942373138,49.3105042753597,51.6559053982909,54.0817304911471,56.5806124389677,59.1451841267927,61.7680784396617,64.4419282626143,67.1593664806902,69.9130259789292,72.6955396423709,75.499540356055,78.3176610050212],[44.2934504995279,42.8726213610329,41.8133518112184,41.1095479729036,40.7551159689078,40.7439619220505,41.0699919551508,41.7271100945738,42.6960637874384,43.9339157522579,45.3983391718991,47.0412705859411,48.8015721140483,50.6663404269146,52.6292130118151,54.6838273560251,56.8238209468198,59.0428312714744,61.3344958172643,63.6924520714645,66.1103375213504,68.5817896541972,71.1004459572801,73.6599439178743,76.2539210232551],[50.2094891167746,48.4185100651942,47.0441296627527,46.0584897351602,45.4337321081266,45.141998607362,45.1554310585764,45.4461706882823,45.9842841484675,46.739577843413,47.6836030201749,48.7954995114867,50.094492105957,51.5705104006748,53.2071789780021,54.9881224203006,56.8969653099323,58.917332229259,61.0328477606426,63.2271364864449,65.4838229890278,67.7865318507532,70.118887653983,72.4645149810789,74.8070384144029],[56.0339794720617,53.9686205919085,52.2441154160032,50.8522179477299,49.7846821904729,49.033262147616,48.5897118225435,48.4457852186394,48.5932363392879,49.0238191878729,49.7292877677786,50.6903126817682,51.8340161260457,53.1378741364767,54.5890861516659,56.1748516102174,57.8823699507358,59.6988406118257,61.6114630320912,63.607436650137,65.6739609045673,67.7982352339867,69.9674590769996,72.1688318722105,74.3895530582236],[62.2560597037113,59.8203476866717,57.7619431393099,56.0651459614117,54.7142560527627,53.6935733131487,52.9873976423552,52.5800289401681,52.4557671063728,52.5989120407553,52.993763643101,53.6230271147674,54.4616298044187,55.4916331825196,56.6964901977532,58.0596537988024,59.5645769343503,61.19471255308,62.9335136036744,64.7644330348166,66.6709237951897,68.6364388334767,70.6444310983606,72.6783535385245,74.7216591026514],[68.1482986197961,65.6626854679931,63.5080760731142,61.6720730777238,60.1422791243864,58.9062968556665,57.9517289141288,57.2661779423376,56.8372465828575,56.6525374782529,56.6996532710884,56.9661966039286,57.4397701193378,58.1079764598807,58.9584182681217,59.9786981866253,61.156418857956,62.4791829246783,63.9345930293569,65.510251814556,67.1937619228403,68.9727259967743,70.8347466789225,72.7674266118493,74.7583684381194],[72.2039459364212,69.7899744883569,67.6553777105778,65.7920394388981,64.1918435091317,62.8466737570928,61.7484140185953,60.8889481294534,60.2601599254811,59.8539332424925,59.6621519163015,59.6766997827224,59.889460677569,60.2923184366556,60.8771568957961,61.6358598908046,62.5603112574952,63.6423948316819,64.8739944491788,66.2469939457998,67.7532771573592,69.384727919671,71.1332300685491,72.9906674398078,74.9489238692609],[74.5360985541214,72.2742959419775,70.2466308405408,68.4483898628798,66.874859622063,65.521326731159,64.3830778032364,63.4553994513635,62.733578288609,62.2129009280414,61.8886539827292,61.7561240657409,61.8105977901451,62.0473617690102,62.4617026154049,63.0489069423976,63.8042613630568,64.7230524904512,65.8005669376491,67.0320913177192,68.41291224373,69.93831632875,71.6035901858477,73.4040204280916,75.3348936685503],[75.3758942119151,73.3332020859096,71.4854147916742,69.8304304699475,68.3661472614679,67.0904633069742,66.0012767472048,65.0964857228984,64.3739883747935,63.8316828436286,63.4674672701424,63.2792397950735,63.2648985591602,63.4223417031414,63.7494673677555,64.244173693741,64.9043588218367,65.7279208927809,66.7127580473124,67.8567684261696,69.1578501700912,70.6139014198156,72.2228203160816,73.9825049996276,75.8908536111922],[74.9544706488208,73.184245177208,71.5753088926493,70.1274673803798,68.8405262256341,67.7142910136471,66.7485673296536,65.9431607588886,65.2978768865868,64.8125212979832,64.4868995783124,64.3208173128094,64.314080086709,64.4664934852461,64.7778630936555,65.247994497172,65.8766932810305,66.6637650304658,67.6090153307128,68.7122497670063,69.9732739245812,71.3918933886722,72.9679137445143,74.7011405773423,76.5913794723909],[73.5029656038568,72.0449774729272,70.7198924721374,69.5288067144554,68.4728163128491,67.5530173802865,66.7705060297357,66.1263783741647,65.6217305265414,65.2576585998339,65.0352587070101,64.9556269610381,65.0198594748857,65.2290523615212,65.5843017339124,66.0867037050274,66.7373543878341,67.5373498953006,68.4877863403949,69.5897598360848,70.8443664953386,72.2527024311241,73.8158637564094,75.5349465841624,77.4110470273511],[71.2525168160414,70.132951230122,69.1227448588096,68.223754592453,67.4378373214007,66.7668499360015,66.2126493266041,65.7770923835572,65.4620359972096,65.2693370579098,65.2008524560066,65.2584390818487,65.4439538257848,65.7592535781637,66.2061952293339,66.7866356696442,67.5024317894433,68.35544047908,69.3475186289028,70.4805231292605,71.7563108705019,73.1767387429755,74.7436636370302,76.4589424430145,78.3244320512773],[68.4342620243932,67.6657187058471,66.9874453813373,66.4016171346512,65.9104090495765,65.5159962099008,65.2205536994117,65.0262566018968,64.9352800011436,64.9497989809398,65.071988625073,65.3040240173307,65.6480802415006,66.1063323813703,66.6809555207274,67.3741247433593,68.1880151330539,69.1248017735986,70.186659748781,71.3757641423888,72.6942900382095,74.1444125200308,75.7283066716403,77.4481475768254,79.3061103193739],[65.2793389679304,64.8608321571572,64.5175733683915,64.2517004613288,64.0653512956642,63.9606637310934,63.9397756273114,64.0048248440138,64.1579492408959,64.4012866776529,64.7369750139803,65.1671521095734,65.6939558241275,66.3195240173381,67.0459945489004,67.8755052785097,68.8101940658615,69.8521987706511,71.0036572525739,72.2667073713251,73.6434869866001,75.1361339580943,76.746786145503,78.4775814085216,80.3306576068454],[62.0188853856715,61.9358438411069,61.9167081486435,61.9633106927642,62.0774838579515,62.261060028688,62.5158715894563,62.843750924739,63.2465304190187,63.7260424567781,64.2841194224996,64.9225937006661,65.64329767576,66.4480637322639,67.3387242546605,68.3171116274324,69.3850582350621,70.5443964620324,71.7969586928257,73.1445773119247,74.589084703812,76.1323132529702,77.776095343882,79.5222633610298,81.3726496888964],[58.8840390166349,59.1083060147508,59.3884290507646,59.7257539492363,60.1216265347259,60.5773926317936,61.0943980649991,61.6739886589028,62.3175102380644,63.0263086270442,63.8017296504021,64.6451191326981,65.5578228984923,66.5411867723447,67.5965565788153,68.7252781424642,69.9286972878514,71.208159839537,72.5650116220809,74.0005984600431,75.5162661779838,77.113360600463,78.7932275520406,80.5572128572768,82.4066623407314],[56.1059375998389,56.5957709351438,57.1363154034259,57.7283363510237,58.3725991242753,59.069869069519,59.820911533093,60.6264918613357,61.4873754005854,62.4043274971803,63.3781134974586,64.4094987477587,65.4992485944188,66.6481283837773,67.8569034621723,69.1263391759422,70.4572008714252,71.8502538949596,73.3062635928837,74.8259953115358,76.4102143972541,78.0596861963768,79.7751760552424,81.557449320189,83.407271337555],[53.9157188743019,54.6157908593404,55.3639465352988,56.160364018405,57.0052214248871,57.8986968709731,58.8409684728908,59.8322143468685,60.8726126091339,61.9623413759152,63.1015787634404,64.2905028879373,65.5292918656341,66.8181238127587,68.157176845539,69.5466290802032,70.9866586329793,72.477443620095,74.0191621577787,75.611992362258,77.2561123497612,78.9517002365161,80.6989341387508,82.4979921726932,84.3490524545715],[52.5445205790424,53.3859180443954,54.2749017750543,55.211143071659,56.1943132348491,57.2240835652647,58.3001253635455,59.4221099303315,60.5897085662624,61.8025925719781,63.0604332481184,64.3629018953232,65.7096698142323,67.1004083054857,68.5347886697231,70.0124822075844,71.5331602197094,73.096494006738,74.70215486931,76.3498141080653,78.0391430236437,79.769812916685,81.5414950878293,83.3538608377161,85.2065814669855],[52.2234804530787,53.1237047473635,54.0727604513638,55.0699796310642,56.114694352449,57.2062366815028,58.3439386842101,59.5271324265553,60.755149974523,62.0273233940977,63.3429847512637,64.7014661120057,66.102099542308,67.5442171081553,69.027150875532,70.5502329104225,72.1127952788113,73.714170046683,75.3536892800221,77.0306850448129,78.7444894070401,80.494434432688,82.2798521877413,84.1000747381843,85.9544341500016]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Es posible crear un gráfico con los puntos originales y la superficie del modelo, a continuación el código necesario.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="mod_poli.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;plot3D&quot;</span>)</span>
<span id="cb261-2"><a href="mod_poli.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(<span class="at">x=</span>Prestige<span class="sc">$</span>income,</span>
<span id="cb261-3"><a href="mod_poli.html#cb261-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span>Prestige<span class="sc">$</span>education,</span>
<span id="cb261-4"><a href="mod_poli.html#cb261-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">z=</span>Prestige<span class="sc">$</span>prestige, <span class="at">ticktype=</span><span class="st">&quot;detailed&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>, </span>
<span id="cb261-5"><a href="mod_poli.html#cb261-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty=</span><span class="st">&quot;f&quot;</span>, <span class="at">colkey=</span><span class="cn">FALSE</span>, <span class="at">phi=</span><span class="dv">30</span>, <span class="at">theta=</span><span class="dv">45</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>,</span>
<span id="cb261-6"><a href="mod_poli.html#cb261-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">&#39;Income&#39;</span>,</span>
<span id="cb261-7"><a href="mod_poli.html#cb261-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">&#39;Education&#39;</span>,</span>
<span id="cb261-8"><a href="mod_poli.html#cb261-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab=</span><span class="st">&#39;Prestige&#39;</span>,</span>
<span id="cb261-9"><a href="mod_poli.html#cb261-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">surf=</span><span class="fu">list</span>(<span class="at">x=</span>inc, <span class="at">y=</span>edu, <span class="at">z=</span>fit.prestige,  </span>
<span id="cb261-10"><a href="mod_poli.html#cb261-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">NAcol=</span><span class="st">&quot;black&quot;</span>, <span class="at">shade=</span><span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/loess3-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>¿Qué sucede con la superficie cuando cambiamos el parámetro <code>span</code>?</p>
<p>El efecto de <code>span</code> se puede ver con claridad en la siguiente figura. Cuando <code>span</code> es pequeño la superficie es muy rugosa, para valores altos de <code>span</code> la suferficie se suaviza.</p>
<p align="center">
<img src="images/animation_loess_Prestige.gif" width="400">
</p>
</div>
</div>
<div id="optimización-con-superficies-de-respuesta" class="section level2 unnumbered hasAnchor">
<h2>Optimización con superficies de respuesta<a href="mod_poli.html#optimización-con-superficies-de-respuesta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cuando se tiene una superficie de respuesta, obtenida por métodos paramétricos o no paramétricos, dos preguntas posibles son:</p>
<ol style="list-style-type: decimal">
<li>¿Cuáles valores de las covariables <strong>maximizan</strong> la variable respuesta?</li>
<li>¿Cuáles valores de las covariables <strong>minimizan</strong> la variable respuesta?</li>
</ol>
<p>Ambos problemas se denominan problemas de optimización. Cuando se tiene una o dos covariables, el problema es sencillo, y se puede resolver dibujando la curva o la superficie, y visualmente se puede obtener el valor o valores de las <span class="math inline">\(x&#39;\)</span>s que optimizan la variable respuesta. Cuando se tienen tres o más covariables es necesario usar métodos de optimización, algunas de las funciones más usuales de R para hacer esto son:</p>
<ol style="list-style-type: decimal">
<li>función <code>nlminb</code>,</li>
<li>función <code>optim</code>.</li>
</ol>
<div id="función-nlminb" class="section level3 unnumbered hasAnchor">
<h3>Función <code>nlminb</code><a href="mod_poli.html#función-nlminb" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La estructura de esta función es la siguiente:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="mod_poli.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nlminb</span>(start, objective, <span class="at">gradient =</span> <span class="cn">NULL</span>, <span class="at">hessian =</span> <span class="cn">NULL</span>, ...,</span>
<span id="cb262-2"><a href="mod_poli.html#cb262-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">scale =</span> <span class="dv">1</span>, <span class="at">control =</span> <span class="fu">list</span>(), <span class="at">lower =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<p>Los parámetros de la función son:</p>
<ul>
<li><code>start</code>: vector con los valores donde inicia la búsqueda.</li>
<li><code>objective</code>: función a MINIMIZAR. El primer argumento de esta función debe ser un vector y ella debe entregar un valor.</li>
<li><code>gradient</code>: función opcional que calcula el gradiente.</li>
<li><code>hessian</code>: función opcional que calcula la hessiana.</li>
<li><code>lower</code>: vector con los valores mínimos de la región de búsqueda.</li>
<li><code>upper</code>: vector con los valores máximos de la región de búsqueda.</li>
</ul>

<div class="rmdtip">
Maximizar la función <span class="math inline">\(f(x)\)</span> es equivalente a minimizar la función <span class="math inline">\(-f(x)\)</span>. Esto es importante para hacer optimización.
</div>
</div>
<div id="ejemplo-41" class="section level3 unnumbered hasAnchor">
<h3>Ejemplo<a href="mod_poli.html#ejemplo-41" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a utilizar aquí unos datos de un experimento en el cual se estudió la influencia de la temperatura y la concentración sobre el rendimiento obtenido en un proceso químico. A continuación los datos del experimento.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="mod_poli.html#cb263-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="fl">189.65</span>, <span class="fl">260.35</span>, <span class="dv">225</span>, <span class="dv">225</span>, <span class="dv">225</span>, <span class="dv">225</span>, <span class="dv">225</span>, <span class="dv">225</span>)</span>
<span id="cb263-2"><a href="mod_poli.html#cb263-2" aria-hidden="true" tabindex="-1"></a>conc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="fl">12.93</span>, <span class="fl">27.07</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb263-3"><a href="mod_poli.html#cb263-3" aria-hidden="true" tabindex="-1"></a>rend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">78</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">48</span>, <span class="dv">76</span>, <span class="dv">65</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">79</span>, <span class="dv">83</span>, <span class="dv">81</span>)</span></code></pre></div>
<p>Vamos a construir un diagrama de dispersión para ver la relación de las variables.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="mod_poli.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb264-2"><a href="mod_poli.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplot3d</span>(<span class="at">x=</span>temp, <span class="at">y=</span>conc, <span class="at">z=</span>rend, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex.lab=</span><span class="fl">1.5</span>,</span>
<span id="cb264-3"><a href="mod_poli.html#cb264-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">highlight.3d=</span><span class="cn">TRUE</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/superficie1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>El objetivo es ajustar el siguiente modelo:</p>
<p><span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\
\mu_i &amp;= \beta_0 + \beta_1 temp_{i} + \beta_2 conc_{i} + \beta_3 temp_i^2 + \beta_4 conc_i^2 + \beta_5 temp \times conc, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
<p>El código para ajustar el modelo es el siguiente.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="mod_poli.html#cb265-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(rend <span class="sc">~</span> temp <span class="sc">+</span> conc <span class="sc">+</span> <span class="fu">I</span>(temp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(conc<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> temp <span class="sc">*</span> conc)</span></code></pre></div>
<p>Usando el modelo ajustado <code>mod</code> es posible dibujar la superfice de respuesta para determinar de forma visual los valores que maximizan el rendimiento.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="mod_poli.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crean 30 valores de las variables para crear la rejilla</span></span>
<span id="cb266-2"><a href="mod_poli.html#cb266-2" aria-hidden="true" tabindex="-1"></a>Temperatura   <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="fl">189.65</span>, <span class="at">to=</span><span class="fl">260.35</span>, <span class="at">length.out=</span><span class="dv">30</span>)</span>
<span id="cb266-3"><a href="mod_poli.html#cb266-3" aria-hidden="true" tabindex="-1"></a>Concentracion <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="fl">12.93</span>, <span class="at">to=</span><span class="fl">27.07</span>, <span class="at">length.out=</span><span class="dv">30</span>)</span>
<span id="cb266-4"><a href="mod_poli.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rend es la funcion a dibujar</span></span>
<span id="cb266-5"><a href="mod_poli.html#cb266-5" aria-hidden="true" tabindex="-1"></a>Rend <span class="ot">&lt;-</span> <span class="cf">function</span>(temp, conc) {</span>
<span id="cb266-6"><a href="mod_poli.html#cb266-6" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod) <span class="sc">*</span> <span class="fu">c</span>(<span class="dv">1</span>, temp, conc, temp<span class="sc">^</span><span class="dv">2</span>, conc<span class="sc">^</span><span class="dv">2</span>, temp <span class="sc">*</span> conc)</span>
<span id="cb266-7"><a href="mod_poli.html#cb266-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(res)</span>
<span id="cb266-8"><a href="mod_poli.html#cb266-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb266-9"><a href="mod_poli.html#cb266-9" aria-hidden="true" tabindex="-1"></a>Rend <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(Rend) <span class="co"># La funcion a dibujar debe estar vectorizada</span></span>
<span id="cb266-10"><a href="mod_poli.html#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="co"># La matriz Rendimiento con las alturas de la superficie se crea con outer</span></span>
<span id="cb266-11"><a href="mod_poli.html#cb266-11" aria-hidden="true" tabindex="-1"></a>Rendimiento <span class="ot">&lt;-</span> <span class="fu">outer</span>(Temperatura, Concentracion, Rend)</span>
<span id="cb266-12"><a href="mod_poli.html#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Para dibujar la superficie de respuesta</span></span>
<span id="cb266-13"><a href="mod_poli.html#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(<span class="at">x=</span>Temperatura, <span class="at">y=</span>Concentracion, <span class="at">z=</span>Rendimiento,</span>
<span id="cb266-14"><a href="mod_poli.html#cb266-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">theta=</span><span class="dv">40</span>, <span class="at">phi=</span><span class="dv">30</span>, <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>, <span class="at">col=</span><span class="st">&#39;salmon1&#39;</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/superficie2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Se puede también construir un gráfico con curvas de nivel para determinar de forma visual los valores que maximizan el rendimiento.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="mod_poli.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(<span class="at">x=</span>Temperatura, <span class="at">y=</span>Concentracion, <span class="at">z=</span>Rendimiento,</span>
<span id="cb267-2"><a href="mod_poli.html#cb267-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">nlevels=</span><span class="dv">10</span>, <span class="at">col=</span><span class="fu">gray</span>(<span class="fl">0.3</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">&#39;solid&#39;</span>,</span>
<span id="cb267-3"><a href="mod_poli.html#cb267-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&#39;Temperatura&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Concentracion&#39;</span>, <span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/superficie3-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Un gráfico de calor es también útil para determinar de forma visual los valores que maximizan el rendimiento.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="mod_poli.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filled.contour</span>(<span class="at">x=</span>Temperatura, <span class="at">y=</span>Concentracion, <span class="at">z=</span>Rendimiento,</span>
<span id="cb268-2"><a href="mod_poli.html#cb268-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">nlevels=</span><span class="dv">10</span>, <span class="at">xlab=</span><span class="st">&#39;Temperatura&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Concentracion&#39;</span>,</span>
<span id="cb268-3"><a href="mod_poli.html#cb268-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">las=</span><span class="dv">1</span>, <span class="at">color.palette =</span> cm.colors)</span></code></pre></div>
<p><img src="Regresion_con_R_files/figure-html/superficie4-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Para encontrar los valores exactos que maximizan el rendimiento se usa la función <code>nlminb</code>. A continuación se crea la función <code>minus_rend</code> que representa <span class="math inline">\(-f(x)\)</span> la cual va a ser minimizada. Se define el punto de inicio de la búsqueda en el objeto <code>inicio</code> y luego el resultado de <code>nlminb</code> se almacena en el objeto <code>res</code>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="mod_poli.html#cb269-1" aria-hidden="true" tabindex="-1"></a>minus_rend <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb269-2"><a href="mod_poli.html#cb269-2" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb269-3"><a href="mod_poli.html#cb269-3" aria-hidden="true" tabindex="-1"></a>  conc <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb269-4"><a href="mod_poli.html#cb269-4" aria-hidden="true" tabindex="-1"></a>  new.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">temp=</span><span class="fu">c</span>(<span class="dv">1</span>, temp), <span class="at">conc=</span><span class="fu">c</span>(<span class="dv">1</span>, conc))</span>
<span id="cb269-5"><a href="mod_poli.html#cb269-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">predict</span>(mod, new.data)[<span class="dv">2</span>]</span>
<span id="cb269-6"><a href="mod_poli.html#cb269-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb269-7"><a href="mod_poli.html#cb269-7" aria-hidden="true" tabindex="-1"></a>inicio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">192</span>, <span class="dv">15</span>)  <span class="co"># valores iniciales para la busqueda</span></span>
<span id="cb269-8"><a href="mod_poli.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(inicio) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Temperatura&#39;</span>, <span class="st">&#39;Concentracion&#39;</span>) <span class="co"># Colocando nombres</span></span>
<span id="cb269-9"><a href="mod_poli.html#cb269-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">nlminb</span>(<span class="at">start=</span>inicio, <span class="at">objective=</span>minus_rend,</span>
<span id="cb269-10"><a href="mod_poli.html#cb269-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">lower=</span><span class="fu">c</span>(<span class="fl">189.65</span>, <span class="fl">12.93</span>), <span class="co"># minimos de las variables</span></span>
<span id="cb269-11"><a href="mod_poli.html#cb269-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">upper=</span><span class="fu">c</span>(<span class="fl">260.35</span>, <span class="fl">27.07</span>), <span class="co"># maximos de las variables</span></span>
<span id="cb269-12"><a href="mod_poli.html#cb269-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">control=</span><span class="fu">list</span>(<span class="at">trace=</span><span class="dv">0</span>))</span>
<span id="cb269-13"><a href="mod_poli.html#cb269-13" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>par  <span class="co"># Valores optimos</span></span></code></pre></div>
<pre><code>##   Temperatura Concentracion 
##     238.95190      19.94697</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="mod_poli.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>res<span class="sc">$</span>objective  <span class="co"># Valor del objetivo</span></span></code></pre></div>
<pre><code>## [1] 82.46933</code></pre>

<div class="rmdwarning">
Dentro del objeto res hay mucha más información. Es fundamental que el lector explore esos elementos con la ayuda de la función nlminb.
</div>

<div class="rmdnote">
Una reto interesante para el lector es que replique el ejemplo con la función optim para ver otra forma alternativa de optimizar.
</div>
</div>
</div>
<div id="polinomios-ortogonales" class="section level2 unnumbered hasAnchor">
<h2>Polinomios ortogonales<a href="mod_poli.html#polinomios-ortogonales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Estamos preparando el contenido, revisar luego.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-mpv06" class="csl-entry">
Montgomery, E. &amp; Vining, D. &amp; Peck. 2006. <em>Introducción Al Análisis de Regresión Lineal</em>. 3ed ed. México: Cecsa.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="indep.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selec.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_regresion/edit/master/12-mod_poli.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
